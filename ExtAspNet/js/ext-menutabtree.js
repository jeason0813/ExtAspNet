Ext.menu.Menu=Ext.extend(Ext.Container,{minWidth:120,shadow:"sides",subMenuAlign:"tl-tr?",defaultAlign:"tl-bl?",allowOtherMenus:false,ignoreParentClicks:false,enableScrolling:true,maxHeight:null,scrollIncrement:24,showSeparator:true,defaultOffsets:[0,0],plain:false,floating:true,zIndex:15000,hidden:true,layout:"menu",hideMode:"offsets",scrollerHeight:8,autoLayout:true,defaultType:"menuitem",bufferResize:false,initComponent:function(){if(Ext.isArray(this.initialConfig)){Ext.apply(this,{items:this.initialConfig})}this.addEvents("click","mouseover","mouseout","itemclick");Ext.menu.MenuMgr.register(this);if(this.floating){Ext.EventManager.onWindowResize(this.hide,this)}else{if(this.initialConfig.hidden!==false){this.hidden=false}this.internalDefaults={hideOnClick:false}}Ext.menu.Menu.superclass.initComponent.call(this);if(this.autoLayout){var b=this.doLayout.createDelegate(this,[]);this.on({add:b,remove:b})}},getLayoutTarget:function(){return this.ul},onRender:function(d,e){if(!d){d=Ext.getBody()}var f={id:this.getId(),cls:"x-menu "+((this.floating)?"x-menu-floating x-layer ":"")+(this.cls||"")+(this.plain?" x-menu-plain":"")+(this.showSeparator?"":" x-menu-nosep"),style:this.style,cn:[{tag:"a",cls:"x-menu-focus",href:"#",onclick:"return false;",tabIndex:"-1"},{tag:"ul",cls:"x-menu-list"}]};if(this.floating){this.el=new Ext.Layer({shadow:this.shadow,dh:f,constrain:false,parentEl:d,zindex:this.zIndex})}else{this.el=d.createChild(f)}Ext.menu.Menu.superclass.onRender.call(this,d,e);if(!this.keyNav){this.keyNav=new Ext.menu.MenuNav(this)}this.focusEl=this.el.child("a.x-menu-focus");this.ul=this.el.child("ul.x-menu-list");this.mon(this.ul,{scope:this,click:this.onClick,mouseover:this.onMouseOver,mouseout:this.onMouseOut});if(this.enableScrolling){this.mon(this.el,{scope:this,delegate:".x-menu-scroller",click:this.onScroll,mouseover:this.deactivateActive})}},findTargetItem:function(c){var d=c.getTarget(".x-menu-list-item",this.ul,true);if(d&&d.menuItemId){return this.items.get(d.menuItemId)}},onClick:function(c){var d=this.findTargetItem(c);if(d){if(d.isFormField){this.setActiveItem(d)}else{if(d instanceof Ext.menu.BaseItem){if(d.menu&&this.ignoreParentClicks){d.expandMenu();c.preventDefault()}else{if(d.onClick){d.onClick(c);this.fireEvent("click",this,d,c)}}}}}},setActiveItem:function(d,c){if(d!=this.activeItem){this.deactivateActive();if((this.activeItem=d).isFormField){d.focus()}else{d.activate(c)}}else{if(c){d.expandMenu()}}},deactivateActive:function(){var a=this.activeItem;if(a){if(a.isFormField){if(a.collapse){a.collapse()}}else{a.deactivate()}delete this.activeItem}},tryActivate:function(i,j){var g=this.items;for(var l=i,h=g.length;l>=0&&l<h;l+=j){var k=g.get(l);if(k.isVisible()&&!k.disabled&&(k.canActivate||k.isFormField)){this.setActiveItem(k,false);return k}}return false},onMouseOver:function(c){var d=this.findTargetItem(c);if(d){if(d.canActivate&&!d.disabled){this.setActiveItem(d,true)}}this.over=true;this.fireEvent("mouseover",this,c,d)},onMouseOut:function(c){var d=this.findTargetItem(c);if(d){if(d==this.activeItem&&d.shouldDeactivate&&d.shouldDeactivate(c)){this.activeItem.deactivate();delete this.activeItem}}this.over=false;this.fireEvent("mouseout",this,c,d)},onScroll:function(g,e){if(g){g.stopEvent()}var f=this.ul.dom,h=Ext.fly(e).is(".x-menu-scroller-top");f.scrollTop+=this.scrollIncrement*(h?-1:1);if(h?f.scrollTop<=0:f.scrollTop+this.activeMax>=f.scrollHeight){this.onScrollerOut(null,e)}},onScrollerIn:function(g,e){var f=this.ul.dom,h=Ext.fly(e).is(".x-menu-scroller-top");if(h?f.scrollTop>0:f.scrollTop+this.activeMax<f.scrollHeight){Ext.fly(e).addClass(["x-menu-item-active","x-menu-scroller-active"])}},onScrollerOut:function(c,d){Ext.fly(d).removeClass(["x-menu-item-active","x-menu-scroller-active"])},show:function(d,f,e){if(this.floating){this.parentMenu=e;if(!this.el){this.render();this.doLayout(false,true)}this.showAt(this.el.getAlignToXY(d,f||this.defaultAlign,this.defaultOffsets),e)}else{Ext.menu.Menu.superclass.show.call(this)}},showAt:function(c,d){if(this.fireEvent("beforeshow",this)!==false){this.parentMenu=d;if(!this.el){this.render()}if(this.enableScrolling){this.el.setXY(c);c[1]=this.constrainScroll(c[1]);c=[this.el.adjustForConstraints(c)[0],c[1]]}else{c=this.el.adjustForConstraints(c)}this.el.setXY(c);this.el.show();Ext.menu.Menu.superclass.onShow.call(this);if(Ext.isIE){this.fireEvent("autosize",this);if(!Ext.isIE8){this.el.repaint()}}this.hidden=false;this.focus();this.fireEvent("show",this)}},constrainScroll:function(k){var i,o=this.ul.setHeight("auto").getHeight(),j=k,l,n,m,p;if(this.floating){n=Ext.fly(this.el.dom.parentNode);m=n.getScroll().top;p=n.getViewSize().height;l=k-m;i=this.maxHeight?this.maxHeight:p-l;if(o>p){i=p;j=k-l}else{if(i<o){j=k-(o-i);i=o}}}else{i=this.getHeight()}if(this.maxHeight){i=Math.min(this.maxHeight,i)}if(o>i&&i>0){this.activeMax=i-this.scrollerHeight*2-this.el.getFrameWidth("tb")-Ext.num(this.el.shadowOffset,0);this.ul.setHeight(this.activeMax);this.createScrollers();this.el.select(".x-menu-scroller").setDisplayed("")}else{this.ul.setHeight(o);this.el.select(".x-menu-scroller").setDisplayed("none")}this.ul.dom.scrollTop=0;return j},createScrollers:function(){if(!this.scroller){this.scroller={pos:0,top:this.el.insertFirst({tag:"div",cls:"x-menu-scroller x-menu-scroller-top",html:"&#160;"}),bottom:this.el.createChild({tag:"div",cls:"x-menu-scroller x-menu-scroller-bottom",html:"&#160;"})};this.scroller.top.hover(this.onScrollerIn,this.onScrollerOut,this);this.scroller.topRepeater=new Ext.util.ClickRepeater(this.scroller.top,{listeners:{click:this.onScroll.createDelegate(this,[null,this.scroller.top],false)}});this.scroller.bottom.hover(this.onScrollerIn,this.onScrollerOut,this);this.scroller.bottomRepeater=new Ext.util.ClickRepeater(this.scroller.bottom,{listeners:{click:this.onScroll.createDelegate(this,[null,this.scroller.bottom],false)}})}},onLayout:function(){if(this.isVisible()){if(this.enableScrolling){this.constrainScroll(this.el.getTop())}if(this.floating){this.el.sync()}}},focus:function(){if(!this.hidden){this.doFocus.defer(50,this)}},doFocus:function(){if(!this.hidden){this.focusEl.focus()}},hide:function(b){if(!this.isDestroyed){this.deepHide=b;Ext.menu.Menu.superclass.hide.call(this);delete this.deepHide}},onHide:function(){Ext.menu.Menu.superclass.onHide.call(this);this.deactivateActive();if(this.el&&this.floating){this.el.hide()}var b=this.parentMenu;if(this.deepHide===true&&b){if(b.floating){b.hide(true)}else{b.deactivateActive()}}},lookupComponent:function(b){if(Ext.isString(b)){b=(b=="separator"||b=="-")?new Ext.menu.Separator():new Ext.menu.TextItem(b);this.applyDefaults(b)}else{if(Ext.isObject(b)){b=this.getMenuItem(b)}else{if(b.tagName||b.el){b=new Ext.BoxComponent({el:b})}}}return b},applyDefaults:function(c){if(!Ext.isString(c)){c=Ext.menu.Menu.superclass.applyDefaults.call(this,c);var d=this.internalDefaults;if(d){if(c.events){Ext.applyIf(c.initialConfig,d);Ext.apply(c,d)}else{Ext.applyIf(c,d)}}}return c},getMenuItem:function(b){b.ownerCt=this;if(!b.isXType){if(!b.xtype&&Ext.isBoolean(b.checked)){return new Ext.menu.CheckItem(b)}return Ext.create(b,this.defaultType)}return b},addSeparator:function(){return this.add(new Ext.menu.Separator())},addElement:function(b){return this.add(new Ext.menu.BaseItem({el:b}))},addItem:function(b){return this.add(b)},addMenuItem:function(b){return this.add(this.getMenuItem(b))},addText:function(b){return this.add(new Ext.menu.TextItem(b))},onDestroy:function(){Ext.EventManager.removeResizeListener(this.hide,this);var d=this.parentMenu;if(d&&d.activeChild==this){delete d.activeChild}delete this.parentMenu;Ext.menu.Menu.superclass.onDestroy.call(this);Ext.menu.MenuMgr.unregister(this);if(this.keyNav){this.keyNav.disable()}var c=this.scroller;if(c){Ext.destroy(c.topRepeater,c.bottomRepeater,c.top,c.bottom)}Ext.destroy(this.el,this.focusEl,this.ul)}});Ext.reg("menu",Ext.menu.Menu);Ext.menu.MenuNav=Ext.extend(Ext.KeyNav,function(){function d(a,b){if(!b.tryActivate(b.items.indexOf(b.activeItem)-1,-1)){b.tryActivate(b.items.length-1,-1)}}function c(a,b){if(!b.tryActivate(b.items.indexOf(b.activeItem)+1,1)){b.tryActivate(0,1)}}return{constructor:function(a){Ext.menu.MenuNav.superclass.constructor.call(this,a.el);this.scope=this.menu=a},doRelay:function(a,b){var e=a.getKey();if(this.menu.activeItem&&this.menu.activeItem.isFormField&&e!=a.TAB){return false}if(!this.menu.activeItem&&a.isNavKeyPress()&&e!=a.SPACE&&e!=a.RETURN){this.menu.tryActivate(0,1);return false}return b.call(this.scope||this,a,this.menu)},tab:function(a,b){a.stopEvent();if(a.shiftKey){d(a,b)}else{c(a,b)}},up:d,down:c,right:function(a,b){if(b.activeItem){b.activeItem.expandMenu(true)}},left:function(a,b){b.hide();if(b.parentMenu&&b.parentMenu.activeItem){b.parentMenu.activeItem.activate()}},enter:function(a,b){if(b.activeItem){a.stopPropagation();b.activeItem.onClick(a);b.fireEvent("click",this,b.activeItem);return true}}}}());Ext.menu.MenuMgr=function(){var t,v,y,w={},z=false,p=new Date();function n(){t={};v=new Ext.util.MixedCollection();y=Ext.getDoc().addKeyListener(27,r);y.disable()}function r(){if(v&&v.length>0){var a=v.clone();a.each(function(b){b.hide()});return true}return false}function u(a){v.remove(a);if(v.length<1){y.disable();Ext.getDoc().un("mousedown",o);z=false}}function q(b){var a=v.last();p=new Date();v.add(b);if(!z){y.enable();Ext.getDoc().on("mousedown",o);z=true}if(b.parentMenu){b.getEl().setZIndex(parseInt(b.parentMenu.getEl().getStyle("z-index"),10)+3);b.parentMenu.activeChild=b}else{if(a&&!a.isDestroyed&&a.isVisible()){b.getEl().setZIndex(parseInt(a.getEl().getStyle("z-index"),10)+3)}}}function x(a){if(a.activeChild){a.activeChild.hide()}if(a.autoHideTimer){clearTimeout(a.autoHideTimer);delete a.autoHideTimer}}function s(b){var a=b.parentMenu;if(!a&&!b.allowOtherMenus){r()}else{if(a&&a.activeChild){a.activeChild.hide()}}}function o(a){if(p.getElapsed()>50&&v.length>0&&!a.getTarget(".x-menu")){r()}}return{hideAll:function(){return r()},register:function(a){if(!t){n()}t[a.id]=a;a.on({beforehide:x,hide:u,beforeshow:s,show:q})},get:function(a){if(typeof a=="string"){if(!t){return null}return t[a]}else{if(a.events){return a}else{if(typeof a.length=="number"){return new Ext.menu.Menu({items:a})}else{return Ext.create(a,"menu")}}}},unregister:function(a){delete t[a.id];a.un("beforehide",x);a.un("hide",u);a.un("beforeshow",s);a.un("show",q)},registerCheckable:function(b){var a=b.group;if(a){if(!w[a]){w[a]=[]}w[a].push(b)}},unregisterCheckable:function(b){var a=b.group;if(a){w[a].remove(b)}},onCheckChange:function(d,c){if(d.group&&c){var a=w[d.group],e=0,f=a.length,b;for(;e<f;e++){b=a[e];if(b!=d){b.setChecked(false)}}}},getCheckedItem:function(b){var a=w[b];if(a){for(var c=0,d=a.length;c<d;c++){if(a[c].checked){return a[c]}}}return null},setCheckedItem:function(c,a){var b=w[c];if(b){for(var d=0,e=b.length;d<e;d++){if(b[d].id==a){b[d].setChecked(true)}}}return null}}}();Ext.menu.BaseItem=Ext.extend(Ext.Component,{canActivate:false,activeClass:"x-menu-item-active",hideOnClick:true,clickHideDelay:1,ctype:"Ext.menu.BaseItem",actionMode:"container",initComponent:function(){Ext.menu.BaseItem.superclass.initComponent.call(this);this.addEvents("click","activate","deactivate");if(this.handler){this.on("click",this.handler,this.scope)}},onRender:function(c,d){Ext.menu.BaseItem.superclass.onRender.apply(this,arguments);if(this.ownerCt&&this.ownerCt instanceof Ext.menu.Menu){this.parentMenu=this.ownerCt}else{this.container.addClass("x-menu-list-item");this.mon(this.el,{scope:this,click:this.onClick,mouseenter:this.activate,mouseleave:this.deactivate})}},setHandler:function(c,d){if(this.handler){this.un("click",this.handler,this.scope)}this.on("click",this.handler=c,this.scope=d)},onClick:function(b){if(!this.disabled&&this.fireEvent("click",this,b)!==false&&(this.parentMenu&&this.parentMenu.fireEvent("itemclick",this,b)!==false)){this.handleClick(b)}else{b.stopEvent()}},activate:function(){if(this.disabled){return false}var b=this.container;b.addClass(this.activeClass);this.region=b.getRegion().adjust(2,2,-2,-2);this.fireEvent("activate",this);return true},deactivate:function(){this.container.removeClass(this.activeClass);this.fireEvent("deactivate",this)},shouldDeactivate:function(b){return !this.region||!this.region.contains(b.getPoint())},handleClick:function(c){var d=this.parentMenu;if(this.hideOnClick){if(d.floating){this.clickHideDelayTimer=d.hide.defer(this.clickHideDelay,d,[true])}else{d.deactivateActive()}}},beforeDestroy:function(){clearTimeout(this.clickHideDelayTimer);Ext.menu.BaseItem.superclass.beforeDestroy.call(this)},expandMenu:Ext.emptyFn,hideMenu:Ext.emptyFn});Ext.reg("menubaseitem",Ext.menu.BaseItem);Ext.menu.TextItem=Ext.extend(Ext.menu.BaseItem,{hideOnClick:false,itemCls:"x-menu-text",constructor:function(b){if(typeof b=="string"){b={text:b}}Ext.menu.TextItem.superclass.constructor.call(this,b)},onRender:function(){var b=document.createElement("span");b.className=this.itemCls;b.innerHTML=this.text;this.el=b;Ext.menu.TextItem.superclass.onRender.apply(this,arguments)}});Ext.reg("menutextitem",Ext.menu.TextItem);Ext.menu.Separator=Ext.extend(Ext.menu.BaseItem,{itemCls:"x-menu-sep",hideOnClick:false,activeClass:"",onRender:function(d){var c=document.createElement("span");c.className=this.itemCls;c.innerHTML="&#160;";this.el=c;d.addClass("x-menu-sep-li");Ext.menu.Separator.superclass.onRender.apply(this,arguments)}});Ext.reg("menuseparator",Ext.menu.Separator);Ext.menu.Item=Ext.extend(Ext.menu.BaseItem,{itemCls:"x-menu-item",canActivate:true,showDelay:200,altText:"",hideDelay:200,ctype:"Ext.menu.Item",initComponent:function(){Ext.menu.Item.superclass.initComponent.call(this);if(this.menu){if(Ext.isArray(this.menu)){this.menu={items:this.menu}}if(Ext.isObject(this.menu)){this.menu.ownerCt=this}this.menu=Ext.menu.MenuMgr.get(this.menu);this.menu.ownerCt=undefined}},onRender:function(e,a){if(!this.itemTpl){this.itemTpl=Ext.menu.Item.prototype.itemTpl=new Ext.XTemplate('<a id="{id}" class="{cls}" hidefocus="true" unselectable="on" href="{href}"','<tpl if="hrefTarget">',' target="{hrefTarget}"',"</tpl>",">",'<img alt="{altText}" src="{icon}" class="x-menu-item-icon {iconCls}"/>','<span class="x-menu-item-text">{text}</span>',"</a>")}var f=this.getTemplateArgs();this.el=a?this.itemTpl.insertBefore(a,f,true):this.itemTpl.append(e,f,true);this.iconEl=this.el.child("img.x-menu-item-icon");this.textEl=this.el.child(".x-menu-item-text");if(!this.href){this.mon(this.el,"click",Ext.emptyFn,null,{preventDefault:true})}Ext.menu.Item.superclass.onRender.call(this,e,a)},getTemplateArgs:function(){return{id:this.id,cls:this.itemCls+(this.menu?" x-menu-item-arrow":"")+(this.cls?" "+this.cls:""),href:this.href||"#",hrefTarget:this.hrefTarget,icon:this.icon||Ext.BLANK_IMAGE_URL,iconCls:this.iconCls||"",text:this.itemText||this.text||"&#160;",altText:this.altText||""}},setText:function(b){this.text=b||"&#160;";if(this.rendered){this.textEl.update(this.text);this.parentMenu.layout.doAutoSize()}},setIconClass:function(d){var c=this.iconCls;this.iconCls=d;if(this.rendered){this.iconEl.replaceClass(c,this.iconCls)}},beforeDestroy:function(){clearTimeout(this.showTimer);clearTimeout(this.hideTimer);if(this.menu){delete this.menu.ownerCt;this.menu.destroy()}Ext.menu.Item.superclass.beforeDestroy.call(this)},handleClick:function(b){if(!this.href){b.stopEvent()}Ext.menu.Item.superclass.handleClick.apply(this,arguments)},activate:function(b){if(Ext.menu.Item.superclass.activate.apply(this,arguments)){this.focus();if(b){this.expandMenu()}}return true},shouldDeactivate:function(b){if(Ext.menu.Item.superclass.shouldDeactivate.call(this,b)){if(this.menu&&this.menu.isVisible()){return !this.menu.getEl().getRegion().contains(b.getPoint())}return true}return false},deactivate:function(){Ext.menu.Item.superclass.deactivate.apply(this,arguments);this.hideMenu()},expandMenu:function(b){if(!this.disabled&&this.menu){clearTimeout(this.hideTimer);delete this.hideTimer;if(!this.menu.isVisible()&&!this.showTimer){this.showTimer=this.deferExpand.defer(this.showDelay,this,[b])}else{if(this.menu.isVisible()&&b){this.menu.tryActivate(0,1)}}}},deferExpand:function(b){delete this.showTimer;this.menu.show(this.container,this.parentMenu.subMenuAlign||"tl-tr?",this.parentMenu);if(b){this.menu.tryActivate(0,1)}},hideMenu:function(){clearTimeout(this.showTimer);delete this.showTimer;if(!this.hideTimer&&this.menu&&this.menu.isVisible()){this.hideTimer=this.deferHide.defer(this.hideDelay,this)}},deferHide:function(){delete this.hideTimer;if(this.menu.over){this.parentMenu.setActiveItem(this,false)}else{this.menu.hide()}}});Ext.reg("menuitem",Ext.menu.Item);Ext.menu.CheckItem=Ext.extend(Ext.menu.Item,{itemCls:"x-menu-item x-menu-check-item",groupClass:"x-menu-group-item",checked:false,ctype:"Ext.menu.CheckItem",initComponent:function(){Ext.menu.CheckItem.superclass.initComponent.call(this);this.addEvents("beforecheckchange","checkchange");if(this.checkHandler){this.on("checkchange",this.checkHandler,this.scope)}Ext.menu.MenuMgr.registerCheckable(this)},onRender:function(b){Ext.menu.CheckItem.superclass.onRender.apply(this,arguments);if(this.group){this.el.addClass(this.groupClass)}if(this.checked){this.checked=false;this.setChecked(true,true)}},destroy:function(){Ext.menu.MenuMgr.unregisterCheckable(this);Ext.menu.CheckItem.superclass.destroy.apply(this,arguments)},setChecked:function(d,e){var f=e===true;if(this.checked!=d&&(f||this.fireEvent("beforecheckchange",this,d)!==false)){Ext.menu.MenuMgr.onCheckChange(this,d);if(this.container){this.container[d?"addClass":"removeClass"]("x-menu-item-checked")}this.checked=d;if(!f){this.fireEvent("checkchange",this,d)}}},handleClick:function(b){if(!this.disabled&&!(this.checked&&this.group)){this.setChecked(!this.checked)}Ext.menu.CheckItem.superclass.handleClick.apply(this,arguments)}});Ext.reg("menucheckitem",Ext.menu.CheckItem);Ext.menu.DateMenu=Ext.extend(Ext.menu.Menu,{enableScrolling:false,hideOnClick:true,pickerId:null,cls:"x-date-menu",initComponent:function(){this.on("beforeshow",this.onBeforeShow,this);if(this.strict=(Ext.isIE7&&Ext.isStrict)){this.on("show",this.onShow,this,{single:true,delay:20})}Ext.apply(this,{plain:true,showSeparator:false,items:this.picker=new Ext.DatePicker(Ext.applyIf({internalRender:this.strict||!Ext.isIE,ctCls:"x-menu-date-item",id:this.pickerId},this.initialConfig))});this.picker.purgeListeners();Ext.menu.DateMenu.superclass.initComponent.call(this);this.relayEvents(this.picker,["select"]);this.on("show",this.picker.focus,this.picker);this.on("select",this.menuHide,this);if(this.handler){this.on("select",this.handler,this.scope||this)}},menuHide:function(){if(this.hideOnClick){this.hide(true)}},onBeforeShow:function(){if(this.picker){this.picker.hideMonthPicker(true)}},onShow:function(){var b=this.picker.getEl();b.setWidth(b.getWidth())}});Ext.reg("datemenu",Ext.menu.DateMenu);Ext.menu.ColorMenu=Ext.extend(Ext.menu.Menu,{enableScrolling:false,hideOnClick:true,cls:"x-color-menu",paletteId:null,initComponent:function(){Ext.apply(this,{plain:true,showSeparator:false,items:this.palette=new Ext.ColorPalette(Ext.applyIf({id:this.paletteId},this.initialConfig))});this.palette.purgeListeners();Ext.menu.ColorMenu.superclass.initComponent.call(this);this.relayEvents(this.palette,["select"]);this.on("select",this.menuHide,this);if(this.handler){this.on("select",this.handler,this.scope||this)}},menuHide:function(){if(this.hideOnClick){this.hide(true)}}});Ext.reg("colormenu",Ext.menu.ColorMenu);Ext.TabPanel=Ext.extend(Ext.Panel,{deferredRender:true,tabWidth:120,minTabWidth:30,resizeTabs:false,enableTabScroll:false,scrollIncrement:0,scrollRepeatInterval:400,scrollDuration:0.35,animScroll:true,tabPosition:"top",baseCls:"x-tab-panel",autoTabs:false,autoTabSelector:"div.x-tab",activeTab:undefined,tabMargin:2,plain:false,wheelIncrement:20,idDelimiter:"__",itemCls:"x-tab-item",elements:"body",headerAsText:false,frame:false,hideBorders:true,initComponent:function(){this.frame=false;Ext.TabPanel.superclass.initComponent.call(this);this.addEvents("beforetabchange","tabchange","contextmenu");this.setLayout(new Ext.layout.CardLayout(Ext.apply({layoutOnCardChange:this.layoutOnTabChange,deferredRender:this.deferredRender},this.layoutConfig)));if(this.tabPosition=="top"){this.elements+=",header";this.stripTarget="header"}else{this.elements+=",footer";this.stripTarget="footer"}if(!this.stack){this.stack=Ext.TabPanel.AccessStack()}this.initItems()},onRender:function(l,h){Ext.TabPanel.superclass.onRender.call(this,l,h);if(this.plain){var i=this.tabPosition=="top"?"header":"footer";this[i].addClass("x-tab-panel-"+i+"-plain")}var g=this[this.stripTarget];this.stripWrap=g.createChild({cls:"x-tab-strip-wrap",cn:{tag:"ul",cls:"x-tab-strip x-tab-strip-"+this.tabPosition}});var j=(this.tabPosition=="bottom"?this.stripWrap:null);g.createChild({cls:"x-tab-strip-spacer"},j);this.strip=new Ext.Element(this.stripWrap.dom.firstChild);this.edge=this.strip.createChild({tag:"li",cls:"x-tab-edge",cn:[{tag:"span",cls:"x-tab-strip-text",cn:"&#160;"}]});this.strip.createChild({cls:"x-clear"});this.body.addClass("x-tab-panel-body-"+this.tabPosition);if(!this.itemTpl){var k=new Ext.Template('<li class="{cls}" id="{id}"><a class="x-tab-strip-close"></a>','<a class="x-tab-right" href="#"><em class="x-tab-left">','<span class="x-tab-strip-inner"><span class="x-tab-strip-text {iconCls}">{text}</span></span>',"</em></a></li>");k.disableFormats=true;k.compile();Ext.TabPanel.prototype.itemTpl=k}this.items.each(this.initTab,this)},afterRender:function(){Ext.TabPanel.superclass.afterRender.call(this);if(this.autoTabs){this.readTabs(false)}if(this.activeTab!==undefined){var b=Ext.isObject(this.activeTab)?this.activeTab:this.items.get(this.activeTab);delete this.activeTab;this.setActiveTab(b)}},initEvents:function(){Ext.TabPanel.superclass.initEvents.call(this);this.mon(this.strip,{scope:this,mousedown:this.onStripMouseDown,contextmenu:this.onStripContextMenu});if(this.enableTabScroll){this.mon(this.strip,"mousewheel",this.onWheel,this)}},findTargets:function(f){var d=null,e=f.getTarget("li:not(.x-tab-edge)",this.strip);if(e){d=this.getComponent(e.id.split(this.idDelimiter)[1]);if(d.disabled){return{close:null,item:null,el:null}}}return{close:f.getTarget(".x-tab-strip-close",this.strip),item:d,el:e}},onStripMouseDown:function(c){if(c.button!==0){return}c.preventDefault();var d=this.findTargets(c);if(d.close){if(d.item.fireEvent("beforeclose",d.item)!==false){d.item.fireEvent("close",d.item);this.remove(d.item)}return}if(d.item&&d.item!=this.activeTab){this.setActiveTab(d.item)}},onStripContextMenu:function(c){c.preventDefault();var d=this.findTargets(c);if(d.item){this.fireEvent("contextmenu",this,d.item,c)}},readTabs:function(k){if(k===true){this.items.each(function(a){this.remove(a)},this)}var l=this.el.query(this.autoTabSelector);for(var g=0,h=l.length;g<h;g++){var j=l[g],i=j.getAttribute("title");j.removeAttribute("title");this.add({title:i,contentEl:j})}},initTab:function(m,h){var l=this.strip.dom.childNodes[h],k=this.getTemplateArgs(m),n=l?this.itemTpl.insertBefore(l,k):this.itemTpl.append(this.strip,k),i="x-tab-strip-over",j=Ext.get(n);j.hover(function(){if(!m.disabled){j.addClass(i)}},function(){j.removeClass(i)});if(m.tabTip){j.child("span.x-tab-strip-text",true).qtip=m.tabTip}m.tabEl=n;j.select("a").on("click",function(a){if(!a.getPageX()){this.onStripMouseDown(a)}},this,{preventDefault:true});m.on({scope:this,disable:this.onItemDisabled,enable:this.onItemEnabled,titlechange:this.onItemTitleChanged,iconchange:this.onItemIconChanged,beforeshow:this.onBeforeShowItem})},getTemplateArgs:function(c){var d=c.closable?"x-tab-strip-closable":"";if(c.disabled){d+=" x-item-disabled"}if(c.iconCls){d+=" x-tab-with-icon"}if(c.tabCls){d+=" "+c.tabCls}return{id:this.id+this.idDelimiter+c.getItemId(),text:c.title,cls:d,iconCls:c.iconCls||""}},onAdd:function(c){Ext.TabPanel.superclass.onAdd.call(this,c);if(this.rendered){var d=this.items;this.initTab(c,d.indexOf(c));this.delegateUpdates()}},onBeforeAdd:function(d){var e=d.events?(this.items.containsKey(d.getItemId())?d:null):this.items.get(d);if(e){this.setActiveTab(d);return false}Ext.TabPanel.superclass.onBeforeAdd.apply(this,arguments);var f=d.elements;d.elements=f?f.replace(",header",""):f;d.border=(d.border===true)},onRemove:function(f){var c=Ext.get(f.tabEl);if(c){c.select("a").removeAllListeners();Ext.destroy(c)}Ext.TabPanel.superclass.onRemove.call(this,f);this.stack.remove(f);delete f.tabEl;f.un("disable",this.onItemDisabled,this);f.un("enable",this.onItemEnabled,this);f.un("titlechange",this.onItemTitleChanged,this);f.un("iconchange",this.onItemIconChanged,this);f.un("beforeshow",this.onBeforeShowItem,this);if(f==this.activeTab){var e=this.stack.next();if(e){this.setActiveTab(e)}else{if(this.items.getCount()>0){this.setActiveTab(0)}else{this.setActiveTab(null)}}}if(!this.destroying){this.delegateUpdates()}},onBeforeShowItem:function(b){if(b!=this.activeTab){this.setActiveTab(b);return false}},onItemDisabled:function(c){var d=this.getTabEl(c);if(d){Ext.fly(d).addClass("x-item-disabled")}this.stack.remove(c)},onItemEnabled:function(c){var d=this.getTabEl(c);if(d){Ext.fly(d).removeClass("x-item-disabled")}},onItemTitleChanged:function(c){var d=this.getTabEl(c);if(d){Ext.fly(d).child("span.x-tab-strip-text",true).innerHTML=c.title}},onItemIconChanged:function(g,f,h){var e=this.getTabEl(g);if(e){e=Ext.get(e);e.child("span.x-tab-strip-text").replaceClass(h,f);e[Ext.isEmpty(f)?"removeClass":"addClass"]("x-tab-with-icon")}},getTabEl:function(d){var c=this.getComponent(d);return c?c.tabEl:null},onResize:function(){Ext.TabPanel.superclass.onResize.apply(this,arguments);this.delegateUpdates()},beginUpdate:function(){this.suspendUpdates=true},endUpdate:function(){this.suspendUpdates=false;this.delegateUpdates()},hideTabStripItem:function(c){c=this.getComponent(c);var d=this.getTabEl(c);if(d){d.style.display="none";this.delegateUpdates()}this.stack.remove(c)},unhideTabStripItem:function(c){c=this.getComponent(c);var d=this.getTabEl(c);if(d){d.style.display="";this.delegateUpdates()}},delegateUpdates:function(){var b=this.rendered;if(this.suspendUpdates){return}if(this.resizeTabs&&b){this.autoSizeTabs()}if(this.enableTabScroll&&b){this.autoScrollTabs()}},autoSizeTabs:function(){var r=this.items.length,w=this.tabPosition!="bottom"?"header":"footer",v=this[w].dom.offsetWidth,x=this[w].dom.clientWidth;if(!this.resizeTabs||r<1||!x){return}var p=Math.max(Math.min(Math.floor((x-4)/r)-this.tabMargin,this.tabWidth),this.minTabWidth);this.lastTabWidth=p;var n=this.strip.query("li:not(.x-tab-edge)");for(var t=0,q=n.length;t<q;t++){var o=n[t],i=Ext.fly(o).child(".x-tab-strip-inner",true),s=o.offsetWidth,u=i.offsetWidth;i.style.width=(p-(s-u))+"px"}},adjustBodyWidth:function(b){if(this.header){this.header.setWidth(b)}if(this.footer){this.footer.setWidth(b)}return b},setActiveTab:function(f){f=this.getComponent(f);if(this.fireEvent("beforetabchange",this,f,this.activeTab)===false){return}if(!this.rendered){this.activeTab=f;return}if(this.activeTab!=f){if(this.activeTab){var e=this.getTabEl(this.activeTab);if(e){Ext.fly(e).removeClass("x-tab-strip-active")}}this.activeTab=f;if(f){var d=this.getTabEl(f);Ext.fly(d).addClass("x-tab-strip-active");this.stack.add(f);this.layout.setActiveItem(f);this.delegateUpdates();if(this.scrolling){this.scrollToTab(f,this.animScroll)}}this.fireEvent("tabchange",this,f)}},getActiveTab:function(){return this.activeTab||null},getItem:function(b){return this.getComponent(b)},autoScrollTabs:function(){this.pos=this.tabPosition=="bottom"?this.footer:this.header;var l=this.items.length,o=this.pos.dom.offsetWidth,p=this.pos.dom.clientWidth,m=this.stripWrap,n=m.dom,i=n.offsetWidth,k=this.getScrollPos(),j=this.edge.getOffsetsTo(this.stripWrap)[0]+k;if(!this.enableTabScroll||i<20){return}if(l==0||j<=p){n.scrollLeft=0;m.setWidth(p);if(this.scrolling){this.scrolling=false;this.pos.removeClass("x-tab-scrolling");this.scrollLeft.hide();this.scrollRight.hide();if(Ext.isAir||Ext.isWebKit){n.style.marginLeft="";n.style.marginRight=""}}}else{if(!this.scrolling){this.pos.addClass("x-tab-scrolling");if(Ext.isAir||Ext.isWebKit){n.style.marginLeft="18px";n.style.marginRight="18px"}}p-=m.getMargins("lr");m.setWidth(p>20?p:20);if(!this.scrolling){if(!this.scrollLeft){this.createScrollers()}else{this.scrollLeft.show();this.scrollRight.show()}}this.scrolling=true;if(k>(j-p)){n.scrollLeft=j-p}else{this.scrollToTab(this.activeTab,false)}this.updateScrollButtons()}},createScrollers:function(){this.pos.addClass("x-tab-scrolling-"+this.tabPosition);var f=this.stripWrap.dom.offsetHeight;var e=this.pos.insertFirst({cls:"x-tab-scroller-left"});e.setHeight(f);e.addClassOnOver("x-tab-scroller-left-over");this.leftRepeater=new Ext.util.ClickRepeater(e,{interval:this.scrollRepeatInterval,handler:this.onScrollLeft,scope:this});this.scrollLeft=e;var d=this.pos.insertFirst({cls:"x-tab-scroller-right"});d.setHeight(f);d.addClassOnOver("x-tab-scroller-right-over");this.rightRepeater=new Ext.util.ClickRepeater(d,{interval:this.scrollRepeatInterval,handler:this.onScrollRight,scope:this});this.scrollRight=d},getScrollWidth:function(){return this.edge.getOffsetsTo(this.stripWrap)[0]+this.getScrollPos()},getScrollPos:function(){return parseInt(this.stripWrap.dom.scrollLeft,10)||0},getScrollArea:function(){return parseInt(this.stripWrap.dom.clientWidth,10)||0},getScrollAnim:function(){return{duration:this.scrollDuration,callback:this.updateScrollButtons,scope:this}},getScrollIncrement:function(){return this.scrollIncrement||(this.resizeTabs?this.lastTabWidth+2:100)},scrollToTab:function(l,i){if(!l){return}var n=this.getTabEl(l),j=this.getScrollPos(),m=this.getScrollArea(),k=Ext.fly(n).getOffsetsTo(this.stripWrap)[0]+j,h=k+n.offsetWidth;if(k<j){this.scrollTo(k,i)}else{if(h>(j+m)){this.scrollTo(h-m,i)}}},scrollTo:function(c,d){this.stripWrap.scrollTo("left",c,d?this.getScrollAnim():false);if(!d){this.updateScrollButtons()}},onWheel:function(k){var j=k.getWheelDelta()*this.wheelIncrement*-1;k.stopEvent();var i=this.getScrollPos(),l=i+j,e=this.getScrollWidth()-this.getScrollArea();var d=Math.max(0,Math.min(e,l));if(d!=i){this.scrollTo(d,false)}},onScrollRight:function(){var e=this.getScrollWidth()-this.getScrollArea(),f=this.getScrollPos(),d=Math.min(e,f+this.getScrollIncrement());if(d!=f){this.scrollTo(d,this.animScroll)}},onScrollLeft:function(){var c=this.getScrollPos(),d=Math.max(0,c-this.getScrollIncrement());if(d!=c){this.scrollTo(d,this.animScroll)}},updateScrollButtons:function(){var b=this.getScrollPos();this.scrollLeft[b===0?"addClass":"removeClass"]("x-tab-scroller-left-disabled");this.scrollRight[b>=(this.getScrollWidth()-this.getScrollArea())?"addClass":"removeClass"]("x-tab-scroller-right-disabled")},beforeDestroy:function(){Ext.destroy(this.leftRepeater,this.rightRepeater);this.deleteMembers("strip","edge","scrollLeft","scrollRight","stripWrap");this.activeTab=null;Ext.TabPanel.superclass.beforeDestroy.apply(this)}});Ext.reg("tabpanel",Ext.TabPanel);Ext.TabPanel.prototype.activate=Ext.TabPanel.prototype.setActiveTab;Ext.TabPanel.AccessStack=function(){var b=[];return{add:function(a){b.push(a);if(b.length>10){b.shift()}},remove:function(f){var g=[];for(var h=0,a=b.length;h<a;h++){if(b[h]!=f){g.push(b[h])}}b=g},next:function(){return b.pop()}}};Ext.ux.TabCloseMenu=Ext.extend(Object,{closeTabText:"Close Tab",closeOtherTabsText:"Close Other Tabs",showCloseAll:true,closeAllTabsText:"Close All Tabs",constructor:function(a){Ext.apply(this,a||{})},init:function(a){this.tabs=a;a.on({scope:this,contextmenu:this.onContextMenu,destroy:this.destroy})},destroy:function(){Ext.destroy(this.menu);delete this.menu;delete this.tabs;delete this.active},onContextMenu:function(b,c,g){this.active=c;var a=this.createMenu(),d=true,h=true,f=a.getComponent("closeall");a.getComponent("close").setDisabled(!c.closable);b.items.each(function(){if(this.closable){d=false;if(this!=c){h=false;return false}}});a.getComponent("closeothers").setDisabled(h);if(f){f.setDisabled(d)}g.stopEvent();a.showAt(g.getPoint())},createMenu:function(){if(!this.menu){var a=[{itemId:"close",text:this.closeTabText,scope:this,handler:this.onClose}];if(this.showCloseAll){a.push("-")}a.push({itemId:"closeothers",text:this.closeOtherTabsText,scope:this,handler:this.onCloseOthers});if(this.showCloseAll){a.push({itemId:"closeall",text:this.closeAllTabsText,scope:this,handler:this.onCloseAll})}this.menu=new Ext.menu.Menu({items:a})}return this.menu},onClose:function(){this.tabs.remove(this.active)},onCloseOthers:function(){this.doClose(true)},onCloseAll:function(){this.doClose(false)},doClose:function(b){var a=[];this.tabs.items.each(function(c){if(c.closable){if(!b||c!=this.active){a.push(c)}}},this);Ext.each(a,function(c){this.tabs.remove(c)},this)}});Ext.preg("tabclosemenu",Ext.ux.TabCloseMenu);Ext.tree.TreePanel=Ext.extend(Ext.Panel,{rootVisible:true,animate:Ext.enableFx,lines:true,enableDD:false,hlDrop:Ext.enableFx,pathSeparator:"/",bubbleEvents:[],initComponent:function(){Ext.tree.TreePanel.superclass.initComponent.call(this);if(!this.eventModel){this.eventModel=new Ext.tree.TreeEventModel(this)}var d=this.loader;if(!d){d=new Ext.tree.TreeLoader({dataUrl:this.dataUrl,requestMethod:this.requestMethod})}else{if(Ext.isObject(d)&&!d.load){d=new Ext.tree.TreeLoader(d)}}this.loader=d;this.nodeHash={};if(this.root){var c=this.root;delete this.root;this.setRootNode(c)}this.addEvents("append","remove","movenode","insert","beforeappend","beforeremove","beforemovenode","beforeinsert","beforeload","load","textchange","beforeexpandnode","beforecollapsenode","expandnode","disabledchange","collapsenode","beforeclick","click","containerclick","checkchange","beforedblclick","dblclick","containerdblclick","contextmenu","containercontextmenu","beforechildrenrendered","startdrag","enddrag","dragdrop","beforenodedrop","nodedrop","nodedragover");if(this.singleExpand){this.on("beforeexpandnode",this.restrictExpand,this)}},proxyNodeEvent:function(n,h,i,j,k,l,m){if(n=="collapse"||n=="expand"||n=="beforecollapse"||n=="beforeexpand"||n=="move"||n=="beforemove"){n=n+"node"}return this.fireEvent(n,h,i,j,k,l,m)},getRootNode:function(){return this.root},setRootNode:function(c){this.destroyRoot();if(!c.render){c=this.loader.createNode(c)}this.root=c;c.ownerTree=this;c.isRoot=true;this.registerNode(c);if(!this.rootVisible){var d=c.attributes.uiProvider;c.ui=d?new d(c):new Ext.tree.RootTreeNodeUI(c)}if(this.innerCt){this.clearInnerCt();this.renderRoot()}return c},clearInnerCt:function(){this.innerCt.update("")},renderRoot:function(){this.root.render();if(!this.rootVisible){this.root.renderChildren()}},getNodeById:function(b){return this.nodeHash[b]},registerNode:function(b){this.nodeHash[b.id]=b},unregisterNode:function(b){delete this.nodeHash[b.id]},toString:function(){return"[Tree"+(this.id?" "+this.id:"")+"]"},restrictExpand:function(d){var c=d.parentNode;if(c){if(c.expandedChild&&c.expandedChild.parentNode==c){c.expandedChild.collapse()}c.expandedChild=d}},getChecked:function(a,h){h=h||this.root;var g=[];var f=function(){if(this.attributes.checked){g.push(!a?this:(a=="id"?this.id:this.attributes[a]))}};h.cascade(f);return g},getLoader:function(){return this.loader},expandAll:function(){this.root.expand(true)},collapseAll:function(){this.root.collapse(true)},getSelectionModel:function(){if(!this.selModel){this.selModel=new Ext.tree.DefaultSelectionModel()}return this.selModel},expandPath:function(k,i,j){if(Ext.isEmpty(k)){if(j){j(false,undefined)}return}i=i||"id";var m=k.split(this.pathSeparator);var n=this.root;if(n.attributes[i]!=m[1]){if(j){j(false,null)}return}var f=1;var l=function(){if(++f==m.length){if(j){j(true,n)}return}var a=n.findChild(i,m[f]);if(!a){if(j){j(false,n)}return}n=a;a.expand(false,false,l)};n.expand(false,false,l)},selectPath:function(j,h,i){if(Ext.isEmpty(j)){if(i){i(false,undefined)}return}h=h||"id";var l=j.split(this.pathSeparator),f=l.pop();if(l.length>1){var k=function(b,c){if(b&&c){var a=c.findChild(h,f);if(a){a.select();if(i){i(true,a)}}else{if(i){i(false,a)}}}else{if(i){i(false,a)}}};this.expandPath(l.join(this.pathSeparator),h,k)}else{this.root.select();if(i){i(true,this.root)}}},getTreeEl:function(){return this.body},onRender:function(c,d){Ext.tree.TreePanel.superclass.onRender.call(this,c,d);this.el.addClass("x-tree");this.innerCt=this.body.createChild({tag:"ul",cls:"x-tree-root-ct "+(this.useArrows?"x-tree-arrows":this.lines?"x-tree-lines":"x-tree-no-lines")})},initEvents:function(){Ext.tree.TreePanel.superclass.initEvents.call(this);if(this.containerScroll){Ext.dd.ScrollManager.register(this.body)}if((this.enableDD||this.enableDrop)&&!this.dropZone){this.dropZone=new Ext.tree.TreeDropZone(this,this.dropConfig||{ddGroup:this.ddGroup||"TreeDD",appendOnly:this.ddAppendOnly===true})}if((this.enableDD||this.enableDrag)&&!this.dragZone){this.dragZone=new Ext.tree.TreeDragZone(this,this.dragConfig||{ddGroup:this.ddGroup||"TreeDD",scroll:this.ddScroll})}this.getSelectionModel().init(this)},afterRender:function(){Ext.tree.TreePanel.superclass.afterRender.call(this);this.renderRoot()},beforeDestroy:function(){if(this.rendered){Ext.dd.ScrollManager.unregister(this.body);Ext.destroy(this.dropZone,this.dragZone)}this.destroyRoot();Ext.destroy(this.loader);this.nodeHash=this.root=this.loader=null;Ext.tree.TreePanel.superclass.beforeDestroy.call(this)},destroyRoot:function(){if(this.root&&this.root.destroy){this.root.destroy(true)}}});Ext.tree.TreePanel.nodeTypes={};Ext.reg("treepanel",Ext.tree.TreePanel);Ext.tree.TreeEventModel=function(b){this.tree=b;this.tree.on("render",this.initEvents,this)};Ext.tree.TreeEventModel.prototype={initEvents:function(){var b=this.tree;if(b.trackMouseOver!==false){b.mon(b.innerCt,{scope:this,mouseover:this.delegateOver,mouseout:this.delegateOut})}b.mon(b.getTreeEl(),{scope:this,click:this.delegateClick,dblclick:this.delegateDblClick,contextmenu:this.delegateContextMenu})},getNode:function(d){var e;if(e=d.getTarget(".x-tree-node-el",10)){var f=Ext.fly(e,"_treeEvents").getAttribute("tree-node-id","ext");if(f){return this.tree.getNodeById(f)}}return null},getNodeTarget:function(c){var d=c.getTarget(".x-tree-node-icon",1);if(!d){d=c.getTarget(".x-tree-node-el",6)}return d},delegateOut:function(d,e){if(!this.beforeEvent(d)){return}if(d.getTarget(".x-tree-ec-icon",1)){var f=this.getNode(d);this.onIconOut(d,f);if(f==this.lastEcOver){delete this.lastEcOver}}if((e=this.getNodeTarget(d))&&!d.within(e,true)){this.onNodeOut(d,this.getNode(d))}},delegateOver:function(c,d){if(!this.beforeEvent(c)){return}if(Ext.isGecko&&!this.trackingDoc){Ext.getBody().on("mouseover",this.trackExit,this);this.trackingDoc=true}if(this.lastEcOver){this.onIconOut(c,this.lastEcOver);delete this.lastEcOver}if(c.getTarget(".x-tree-ec-icon",1)){this.lastEcOver=this.getNode(c);this.onIconOver(c,this.lastEcOver)}if(d=this.getNodeTarget(c)){this.onNodeOver(c,this.getNode(c))}},trackExit:function(b){if(this.lastOverNode){if(this.lastOverNode.ui&&!b.within(this.lastOverNode.ui.getEl())){this.onNodeOut(b,this.lastOverNode)}delete this.lastOverNode;Ext.getBody().un("mouseover",this.trackExit,this);this.trackingDoc=false}},delegateClick:function(c,d){if(this.beforeEvent(c)){if(c.getTarget("input[type=checkbox]",1)){this.onCheckboxClick(c,this.getNode(c))}else{if(c.getTarget(".x-tree-ec-icon",1)){this.onIconClick(c,this.getNode(c))}else{if(this.getNodeTarget(c)){this.onNodeClick(c,this.getNode(c))}}}}else{this.checkContainerEvent(c,"click")}},delegateDblClick:function(c,d){if(this.beforeEvent(c)){if(this.getNodeTarget(c)){this.onNodeDblClick(c,this.getNode(c))}}else{this.checkContainerEvent(c,"dblclick")}},delegateContextMenu:function(c,d){if(this.beforeEvent(c)){if(this.getNodeTarget(c)){this.onNodeContextMenu(c,this.getNode(c))}}else{this.checkContainerEvent(c,"contextmenu")}},checkContainerEvent:function(c,d){if(this.disabled){c.stopEvent();return false}this.onContainerEvent(c,d)},onContainerEvent:function(c,d){this.tree.fireEvent("container"+d,this.tree,c)},onNodeClick:function(c,d){d.ui.onClick(c)},onNodeOver:function(c,d){this.lastOverNode=d;d.ui.onOver(c)},onNodeOut:function(c,d){d.ui.onOut(c)},onIconOver:function(c,d){d.ui.addClass("x-tree-ec-over")},onIconOut:function(c,d){d.ui.removeClass("x-tree-ec-over")},onIconClick:function(c,d){d.ui.ecClick(c)},onCheckboxClick:function(c,d){d.ui.onCheckChange(c)},onNodeDblClick:function(c,d){d.ui.onDblClick(c)},onNodeContextMenu:function(c,d){d.ui.onContextMenu(c)},beforeEvent:function(c){var d=this.getNode(c);if(this.disabled||!d||!d.ui){c.stopEvent();return false}return true},disable:function(){this.disabled=true},enable:function(){this.disabled=false}};Ext.tree.DefaultSelectionModel=Ext.extend(Ext.util.Observable,{constructor:function(b){this.selNode=null;this.addEvents("selectionchange","beforeselect");Ext.apply(this,b);Ext.tree.DefaultSelectionModel.superclass.constructor.call(this)},init:function(b){this.tree=b;b.mon(b.getTreeEl(),"keydown",this.onKeyDown,this);b.on("click",this.onNodeClick,this)},onNodeClick:function(d,c){this.select(d)},select:function(f,e){if(!Ext.fly(f.ui.wrap).isVisible()&&e){return e.call(this,f)}var d=this.selNode;if(f==d){f.ui.onSelectedChange(true)}else{if(this.fireEvent("beforeselect",this,f,d)!==false){if(d&&d.ui){d.ui.onSelectedChange(false)}this.selNode=f;f.ui.onSelectedChange(true);this.fireEvent("selectionchange",this,f,d)}}return f},unselect:function(c,d){if(this.selNode==c){this.clearSelections(d)}},clearSelections:function(d){var c=this.selNode;if(c){c.ui.onSelectedChange(false);this.selNode=null;if(d!==true){this.fireEvent("selectionchange",this,null)}}return c},getSelectedNode:function(){return this.selNode},isSelected:function(b){return this.selNode==b},selectPrevious:function(e){if(!(e=e||this.selNode||this.lastSelNode)){return null}var f=e.previousSibling;if(f){if(!f.isExpanded()||f.childNodes.length<1){return this.select(f,this.selectPrevious)}else{var d=f.lastChild;while(d&&d.isExpanded()&&Ext.fly(d.ui.wrap).isVisible()&&d.childNodes.length>0){d=d.lastChild}return this.select(d,this.selectPrevious)}}else{if(e.parentNode&&(this.tree.rootVisible||!e.parentNode.isRoot)){return this.select(e.parentNode,this.selectPrevious)}}return null},selectNext:function(c){if(!(c=c||this.selNode||this.lastSelNode)){return null}if(c.firstChild&&c.isExpanded()&&Ext.fly(c.ui.wrap).isVisible()){return this.select(c.firstChild,this.selectNext)}else{if(c.nextSibling){return this.select(c.nextSibling,this.selectNext)}else{if(c.parentNode){var d=null;c.parentNode.bubble(function(){if(this.nextSibling){d=this.getOwnerTree().selModel.select(this.nextSibling,this.selectNext);return false}});return d}}}return null},onKeyDown:function(h){var e=this.selNode||this.lastSelNode;var g=this;if(!e){return}var f=h.getKey();switch(f){case h.DOWN:h.stopEvent();this.selectNext();break;case h.UP:h.stopEvent();this.selectPrevious();break;case h.RIGHT:h.preventDefault();if(e.hasChildNodes()){if(!e.isExpanded()){e.expand()}else{if(e.firstChild){this.select(e.firstChild,h)}}}break;case h.LEFT:h.preventDefault();if(e.hasChildNodes()&&e.isExpanded()){e.collapse()}else{if(e.parentNode&&(this.tree.rootVisible||e.parentNode!=this.tree.getRootNode())){this.select(e.parentNode,h)}}break}}});Ext.tree.MultiSelectionModel=Ext.extend(Ext.util.Observable,{constructor:function(b){this.selNodes=[];this.selMap={};this.addEvents("selectionchange");Ext.apply(this,b);Ext.tree.MultiSelectionModel.superclass.constructor.call(this)},init:function(b){this.tree=b;b.mon(b.getTreeEl(),"keydown",this.onKeyDown,this);b.on("click",this.onNodeClick,this)},onNodeClick:function(d,c){if(c.ctrlKey&&this.isSelected(d)){this.unselect(d)}else{this.select(d,c,c.ctrlKey)}},select:function(e,f,d){if(d!==true){this.clearSelections(true)}if(this.isSelected(e)){this.lastSelNode=e;return e}this.selNodes.push(e);this.selMap[e.id]=e;this.lastSelNode=e;e.ui.onSelectedChange(true);this.fireEvent("selectionchange",this,this.selNodes);return e},unselect:function(d){if(this.selMap[d.id]){d.ui.onSelectedChange(false);var f=this.selNodes;var e=f.indexOf(d);if(e!=-1){this.selNodes.splice(e,1)}delete this.selMap[d.id];this.fireEvent("selectionchange",this,this.selNodes)}},clearSelections:function(e){var g=this.selNodes;if(g.length>0){for(var h=0,f=g.length;h<f;h++){g[h].ui.onSelectedChange(false)}this.selNodes=[];this.selMap={};if(e!==true){this.fireEvent("selectionchange",this,this.selNodes)}}},isSelected:function(b){return this.selMap[b.id]?true:false},getSelectedNodes:function(){return this.selNodes.concat([])},onKeyDown:Ext.tree.DefaultSelectionModel.prototype.onKeyDown,selectNext:Ext.tree.DefaultSelectionModel.prototype.selectNext,selectPrevious:Ext.tree.DefaultSelectionModel.prototype.selectPrevious});Ext.data.Tree=Ext.extend(Ext.util.Observable,{constructor:function(b){this.nodeHash={};this.root=null;if(b){this.setRootNode(b)}this.addEvents("append","remove","move","insert","beforeappend","beforeremove","beforemove","beforeinsert");Ext.data.Tree.superclass.constructor.call(this)},pathSeparator:"/",proxyNodeEvent:function(){return this.fireEvent.apply(this,arguments)},getRootNode:function(){return this.root},setRootNode:function(b){this.root=b;b.ownerTree=this;b.isRoot=true;this.registerNode(b);return b},getNodeById:function(b){return this.nodeHash[b]},registerNode:function(b){this.nodeHash[b.id]=b},unregisterNode:function(b){delete this.nodeHash[b.id]},toString:function(){return"[Tree"+(this.id?" "+this.id:"")+"]"}});Ext.data.Node=Ext.extend(Ext.util.Observable,{constructor:function(b){this.attributes=b||{};this.leaf=this.attributes.leaf;this.id=this.attributes.id;if(!this.id){this.id=Ext.id(null,"xnode-");this.attributes.id=this.id}this.childNodes=[];this.parentNode=null;this.firstChild=null;this.lastChild=null;this.previousSibling=null;this.nextSibling=null;this.addEvents({append:true,remove:true,move:true,insert:true,beforeappend:true,beforeremove:true,beforemove:true,beforeinsert:true});this.listeners=this.attributes.listeners;Ext.data.Node.superclass.constructor.call(this)},fireEvent:function(c){if(Ext.data.Node.superclass.fireEvent.apply(this,arguments)===false){return false}var d=this.getOwnerTree();if(d){if(d.proxyNodeEvent.apply(d,arguments)===false){return false}}return true},isLeaf:function(){return this.leaf===true},setFirstChild:function(b){this.firstChild=b},setLastChild:function(b){this.lastChild=b},isLast:function(){return(!this.parentNode?true:this.parentNode.lastChild==this)},isFirst:function(){return(!this.parentNode?true:this.parentNode.firstChild==this)},hasChildNodes:function(){return !this.isLeaf()&&this.childNodes.length>0},isExpandable:function(){return this.attributes.expandable||this.hasChildNodes()},appendChild:function(l){var k=false;if(Ext.isArray(l)){k=l}else{if(arguments.length>1){k=arguments}}if(k){for(var m=0,i=k.length;m<i;m++){this.appendChild(k[m])}}else{if(this.fireEvent("beforeappend",this.ownerTree,this,l)===false){return false}var h=this.childNodes.length;var n=l.parentNode;if(n){if(l.fireEvent("beforemove",l.getOwnerTree(),l,n,this,h)===false){return false}n.removeChild(l)}h=this.childNodes.length;if(h===0){this.setFirstChild(l)}this.childNodes.push(l);l.parentNode=this;var j=this.childNodes[h-1];if(j){l.previousSibling=j;j.nextSibling=l}else{l.previousSibling=null}l.nextSibling=null;this.setLastChild(l);l.setOwnerTree(this.getOwnerTree());this.fireEvent("append",this.ownerTree,this,l,h);if(n){l.fireEvent("move",this.ownerTree,l,n,this,h)}return l}},removeChild:function(f,d){var e=this.childNodes.indexOf(f);if(e==-1){return false}if(this.fireEvent("beforeremove",this.ownerTree,this,f)===false){return false}this.childNodes.splice(e,1);if(f.previousSibling){f.previousSibling.nextSibling=f.nextSibling}if(f.nextSibling){f.nextSibling.previousSibling=f.previousSibling}if(this.firstChild==f){this.setFirstChild(f.nextSibling)}if(this.lastChild==f){this.setLastChild(f.previousSibling)}this.fireEvent("remove",this.ownerTree,this,f);if(d){f.destroy(true)}else{f.clear()}return f},clear:function(b){this.setOwnerTree(null,b);this.parentNode=this.previousSibling=this.nextSibling=null;if(b){this.firstChild=this.lastChild=null}},destroy:function(b){if(b===true){this.purgeListeners();this.clear(true);Ext.each(this.childNodes,function(a){a.destroy(true)});this.childNodes=null}else{this.remove(true)}},insertBefore:function(k,h){if(!h){return this.appendChild(k)}if(k==h){return false}if(this.fireEvent("beforeinsert",this.ownerTree,this,k,h)===false){return false}var g=this.childNodes.indexOf(h);var l=k.parentNode;var j=g;if(l==this&&this.childNodes.indexOf(k)<g){j--}if(l){if(k.fireEvent("beforemove",k.getOwnerTree(),k,l,this,g,h)===false){return false}l.removeChild(k)}if(j===0){this.setFirstChild(k)}this.childNodes.splice(j,0,k);k.parentNode=this;var i=this.childNodes[j-1];if(i){k.previousSibling=i;i.nextSibling=k}else{k.previousSibling=null}k.nextSibling=h;h.previousSibling=k;k.setOwnerTree(this.getOwnerTree());this.fireEvent("insert",this.ownerTree,this,k,h);if(l){k.fireEvent("move",this.ownerTree,k,l,this,j,h)}return k},remove:function(b){if(this.parentNode){this.parentNode.removeChild(this,b)}return this},removeAll:function(e){var f=this.childNodes,d;while((d=f[0])){this.removeChild(d,e)}return this},item:function(b){return this.childNodes[b]},replaceChild:function(e,f){var d=f?f.nextSibling:null;this.removeChild(f);this.insertBefore(e,d);return f},indexOf:function(b){return this.childNodes.indexOf(b)},getOwnerTree:function(){if(!this.ownerTree){var b=this;while(b){if(b.ownerTree){this.ownerTree=b.ownerTree;break}b=b.parentNode}}return this.ownerTree},getDepth:function(){var c=0;var d=this;while(d.parentNode){++c;d=d.parentNode}return c},setOwnerTree:function(d,c){if(d!=this.ownerTree){if(this.ownerTree){this.ownerTree.unregisterNode(this)}this.ownerTree=d;if(c!==true){Ext.each(this.childNodes,function(a){a.setOwnerTree(d)})}if(d){d.registerNode(this)}}},setId:function(c){if(c!==this.id){var d=this.ownerTree;if(d){d.unregisterNode(this)}this.id=this.attributes.id=c;if(d){d.registerNode(this)}this.onIdChange(c)}},onIdChange:Ext.emptyFn,getPath:function(h){h=h||"id";var f=this.parentNode;var b=[this.attributes[h]];while(f){b.unshift(f.attributes[h]);f=f.parentNode}var g=this.getOwnerTree().pathSeparator;return g+b.join(g)},bubble:function(h,e,f){var g=this;while(g){if(h.apply(e||g,f||[g])===false){break}g=g.parentNode}},cascade:function(i,j,g){if(i.apply(j||this,g||[this])!==false){var k=this.childNodes;for(var l=0,h=k.length;l<h;l++){k[l].cascade(i,j,g)}}},eachChild:function(i,j,g){var k=this.childNodes;for(var l=0,h=k.length;l<h;l++){if(i.apply(j||k[l],g||[k[l]])===false){break}}},findChild:function(d,f,e){return this.findChildBy(function(){return this.attributes[d]==f},null,e)},findChildBy:function(l,m,i){var n=this.childNodes,j=n.length,o=0,k,p;for(;o<j;o++){k=n[o];if(l.call(m||k,k)===true){return k}else{if(i){p=k.findChildBy(l,m,i);if(p!=null){return p}}}}return null},sort:function(l,m){var n=this.childNodes;var i=n.length;if(i>0){var k=m?function(){l.apply(m,arguments)}:l;n.sort(k);for(var h=0;h<i;h++){var j=n[h];j.previousSibling=n[h-1];j.nextSibling=n[h+1];if(h===0){this.setFirstChild(j)}if(h==i-1){this.setLastChild(j)}}}},contains:function(b){return b.isAncestor(this)},isAncestor:function(d){var c=this.parentNode;while(c){if(c==d){return true}c=c.parentNode}return false},toString:function(){return"[Node"+(this.id?" "+this.id:"")+"]"}});Ext.tree.TreeNode=Ext.extend(Ext.data.Node,{constructor:function(d){d=d||{};if(Ext.isString(d)){d={text:d}}this.childrenRendered=false;this.rendered=false;Ext.tree.TreeNode.superclass.constructor.call(this,d);this.expanded=d.expanded===true;this.isTarget=d.isTarget!==false;this.draggable=d.draggable!==false&&d.allowDrag!==false;this.allowChildren=d.allowChildren!==false&&d.allowDrop!==false;this.text=d.text;this.disabled=d.disabled===true;this.hidden=d.hidden===true;this.addEvents("textchange","beforeexpand","beforecollapse","expand","disabledchange","collapse","beforeclick","click","checkchange","beforedblclick","dblclick","contextmenu","beforechildrenrendered");var c=this.attributes.uiProvider||this.defaultUI||Ext.tree.TreeNodeUI;this.ui=new c(this)},preventHScroll:true,isExpanded:function(){return this.expanded},getUI:function(){return this.ui},getLoader:function(){var b;return this.loader||((b=this.getOwnerTree())&&b.loader?b.loader:(this.loader=new Ext.tree.TreeLoader()))},setFirstChild:function(d){var c=this.firstChild;Ext.tree.TreeNode.superclass.setFirstChild.call(this,d);if(this.childrenRendered&&c&&d!=c){c.renderIndent(true,true)}if(this.rendered){this.renderIndent(true,true)}},setLastChild:function(c){var d=this.lastChild;Ext.tree.TreeNode.superclass.setLastChild.call(this,c);if(this.childrenRendered&&d&&c!=d){d.renderIndent(true,true)}if(this.rendered){this.renderIndent(true,true)}},appendChild:function(c){if(!c.render&&!Ext.isArray(c)){c=this.getLoader().createNode(c)}var d=Ext.tree.TreeNode.superclass.appendChild.call(this,c);if(d&&this.childrenRendered){d.render()}this.ui.updateExpandIcon();return d},removeChild:function(d,e){this.ownerTree.getSelectionModel().unselect(d);Ext.tree.TreeNode.superclass.removeChild.apply(this,arguments);if(!e){var f=d.ui.rendered;if(f){d.ui.remove()}if(f&&this.childNodes.length<1){this.collapse(false,false)}else{this.ui.updateExpandIcon()}if(!this.firstChild&&!this.isHiddenRoot()){this.childrenRendered=false}}return d},insertBefore:function(f,e){if(!f.render){f=this.getLoader().createNode(f)}var d=Ext.tree.TreeNode.superclass.insertBefore.call(this,f,e);if(d&&e&&this.childrenRendered){f.render()}this.ui.updateExpandIcon();return d},setText:function(c){var d=this.text;this.text=this.attributes.text=c;if(this.rendered){this.ui.onTextChange(this,c,d)}this.fireEvent("textchange",this,c,d)},setIconCls:function(c){var d=this.attributes.iconCls;this.attributes.iconCls=c;if(this.rendered){this.ui.onIconClsChange(this,c,d)}},setTooltip:function(d,c){this.attributes.qtip=d;this.attributes.qtipTitle=c;if(this.rendered){this.ui.onTipChange(this,d,c)}},setIcon:function(b){this.attributes.icon=b;if(this.rendered){this.ui.onIconChange(this,b)}},setHref:function(d,c){this.attributes.href=d;this.attributes.hrefTarget=c;if(this.rendered){this.ui.onHrefChange(this,d,c)}},setCls:function(c){var d=this.attributes.cls;this.attributes.cls=c;if(this.rendered){this.ui.onClsChange(this,c,d)}},select:function(){var b=this.getOwnerTree();if(b){b.getSelectionModel().select(this)}},unselect:function(d){var c=this.getOwnerTree();if(c){c.getSelectionModel().unselect(this,d)}},isSelected:function(){var b=this.getOwnerTree();return b?b.getSelectionModel().isSelected(this):false},expand:function(f,h,g,e){if(!this.expanded){if(this.fireEvent("beforeexpand",this,f,h)===false){return}if(!this.childrenRendered){this.renderChildren()}this.expanded=true;if(!this.isHiddenRoot()&&(this.getOwnerTree().animate&&h!==false)||h){this.ui.animExpand(function(){this.fireEvent("expand",this);this.runCallback(g,e||this,[this]);if(f===true){this.expandChildNodes(true,true)}}.createDelegate(this));return}else{this.ui.expand();this.fireEvent("expand",this);this.runCallback(g,e||this,[this])}}else{this.runCallback(g,e||this,[this])}if(f===true){this.expandChildNodes(true)}},runCallback:function(e,f,d){if(Ext.isFunction(e)){e.apply(f,d)}},isHiddenRoot:function(){return this.isRoot&&!this.getOwnerTree().rootVisible},collapse:function(h,k,j,l){if(this.expanded&&!this.isHiddenRoot()){if(this.fireEvent("beforecollapse",this,h,k)===false){return}this.expanded=false;if((this.getOwnerTree().animate&&k!==false)||k){this.ui.animCollapse(function(){this.fireEvent("collapse",this);this.runCallback(j,l||this,[this]);if(h===true){this.collapseChildNodes(true)}}.createDelegate(this));return}else{this.ui.collapse();this.fireEvent("collapse",this);this.runCallback(j,l||this,[this])}}else{if(!this.expanded){this.runCallback(j,l||this,[this])}}if(h===true){var m=this.childNodes;for(var n=0,i=m.length;n<i;n++){m[n].collapse(true,false)}}},delayedExpand:function(b){if(!this.expandProcId){this.expandProcId=this.expand.defer(b,this)}},cancelExpand:function(){if(this.expandProcId){clearTimeout(this.expandProcId)}this.expandProcId=false},toggle:function(){if(this.expanded){this.collapse()}else{this.expand()}},ensureVisible:function(f,d){var e=this.getOwnerTree();e.expandPath(this.parentNode?this.parentNode.getPath():this.getPath(),false,function(){var a=e.getNodeById(this.id);e.getTreeEl().scrollChildIntoView(a.ui.anchor);this.runCallback(f,d||this,[this])}.createDelegate(this))},expandChildNodes:function(f,h){var i=this.childNodes,j,g=i.length;for(j=0;j<g;j++){i[j].expand(f,h)}},collapseChildNodes:function(e){var g=this.childNodes;for(var h=0,f=g.length;h<f;h++){g[h].collapse(e)}},disable:function(){this.disabled=true;this.unselect();if(this.rendered&&this.ui.onDisableChange){this.ui.onDisableChange(this,true)}this.fireEvent("disabledchange",this,true)},enable:function(){this.disabled=false;if(this.rendered&&this.ui.onDisableChange){this.ui.onDisableChange(this,false)}this.fireEvent("disabledchange",this,false)},renderChildren:function(e){if(e!==false){this.fireEvent("beforechildrenrendered",this)}var g=this.childNodes;for(var h=0,f=g.length;h<f;h++){g[h].render(true)}this.childrenRendered=true},sort:function(h,i){Ext.tree.TreeNode.superclass.sort.apply(this,arguments);if(this.childrenRendered){var j=this.childNodes;for(var f=0,g=j.length;f<g;f++){j[f].render(true)}}},render:function(b){this.ui.render(b);if(!this.rendered){this.getOwnerTree().registerNode(this);this.rendered=true;if(this.expanded){this.expanded=false;this.expand(false,false)}}},renderIndent:function(f,h){if(h){this.ui.childIndent=null}this.ui.renderIndent();if(f===true&&this.childrenRendered){var i=this.childNodes;for(var j=0,g=i.length;j<g;j++){i[j].renderIndent(true,h)}}},beginUpdate:function(){this.childrenRendered=false},endUpdate:function(){if(this.expanded&&this.rendered){this.renderChildren()}},destroy:function(b){if(b===true){this.unselect(true)}Ext.tree.TreeNode.superclass.destroy.call(this,b);Ext.destroy(this.ui,this.loader);this.ui=this.loader=null},onIdChange:function(b){this.ui.onIdChange(b)}});Ext.tree.TreePanel.nodeTypes.node=Ext.tree.TreeNode;Ext.tree.AsyncTreeNode=function(b){this.loaded=b&&b.loaded===true;this.loading=false;Ext.tree.AsyncTreeNode.superclass.constructor.apply(this,arguments);this.addEvents("beforeload","load")};Ext.extend(Ext.tree.AsyncTreeNode,Ext.tree.TreeNode,{expand:function(f,l,j,n){if(this.loading){var k;var m=function(){if(!this.loading){clearInterval(k);this.expand(f,l,j,n)}}.createDelegate(this);k=setInterval(m,200);return}if(!this.loaded){if(this.fireEvent("beforeload",this)===false){return}this.loading=true;this.ui.beforeLoad(this);var i=this.loader||this.attributes.loader||this.getOwnerTree().getLoader();if(i){i.load(this,this.loadComplete.createDelegate(this,[f,l,j,n]),this);return}}Ext.tree.AsyncTreeNode.superclass.expand.call(this,f,l,j,n)},isLoading:function(){return this.loading},loadComplete:function(f,h,g,e){this.loading=false;this.loaded=true;this.ui.afterLoad(this);this.fireEvent("load",this);this.expand(f,h,g,e)},isLoaded:function(){return this.loaded},hasChildNodes:function(){if(!this.isLeaf()&&!this.loaded){return true}else{return Ext.tree.AsyncTreeNode.superclass.hasChildNodes.call(this)}},reload:function(c,d){this.collapse(false,false);while(this.firstChild){this.removeChild(this.firstChild).destroy()}this.childrenRendered=false;this.loaded=false;if(this.isHiddenRoot()){this.expanded=false}this.expand(false,false,c,d)}});Ext.tree.TreePanel.nodeTypes.async=Ext.tree.AsyncTreeNode;Ext.tree.TreeNodeUI=Ext.extend(Object,{constructor:function(b){Ext.apply(this,{node:b,rendered:false,animating:false,wasLeaf:true,ecc:"x-tree-ec-icon x-tree-elbow",emptyIcon:Ext.BLANK_IMAGE_URL})},removeChild:function(b){if(this.rendered){this.ctNode.removeChild(b.ui.getEl())}},beforeLoad:function(){this.addClass("x-tree-node-loading")},afterLoad:function(){this.removeClass("x-tree-node-loading")},onTextChange:function(d,f,e){if(this.rendered){this.textNode.innerHTML=f}},onIconClsChange:function(f,e,d){if(this.rendered){Ext.fly(this.iconNode).replaceClass(d,e)}},onIconChange:function(d,e){if(this.rendered){var f=Ext.isEmpty(e);this.iconNode.src=f?this.emptyIcon:e;Ext.fly(this.iconNode)[f?"removeClass":"addClass"]("x-tree-node-inline-icon")}},onTipChange:function(e,h,g){if(this.rendered){var f=Ext.isDefined(g);if(this.textNode.setAttributeNS){this.textNode.setAttributeNS("ext","qtip",h);if(f){this.textNode.setAttributeNS("ext","qtitle",g)}}else{this.textNode.setAttribute("ext:qtip",h);if(f){this.textNode.setAttribute("ext:qtitle",g)}}}},onHrefChange:function(d,e,f){if(this.rendered){this.anchor.href=this.getHref(e);if(Ext.isDefined(f)){this.anchor.target=f}}},onClsChange:function(f,e,d){if(this.rendered){Ext.fly(this.elNode).replaceClass(d,e)}},onDisableChange:function(d,c){this.disabled=c;if(this.checkbox){this.checkbox.disabled=c}this[c?"addClass":"removeClass"]("x-tree-node-disabled")},onSelectedChange:function(b){if(b){this.focus();this.addClass("x-tree-selected")}else{this.removeClass("x-tree-selected")}},onMove:function(j,l,n,m,o,i){this.childIndent=null;if(this.rendered){var k=m.ui.getContainer();if(!k){this.holder=document.createElement("div");this.holder.appendChild(this.wrap);return}var p=i?i.ui.getEl():null;if(p){k.insertBefore(this.wrap,p)}else{k.appendChild(this.wrap)}this.node.renderIndent(true,n!=m)}},addClass:function(b){if(this.elNode){Ext.fly(this.elNode).addClass(b)}},removeClass:function(b){if(this.elNode){Ext.fly(this.elNode).removeClass(b)}},remove:function(){if(this.rendered){this.holder=document.createElement("div");this.holder.appendChild(this.wrap)}},fireEvent:function(){return this.node.fireEvent.apply(this.node,arguments)},initEvents:function(){this.node.on("move",this.onMove,this);if(this.node.disabled){this.onDisableChange(this.node,true)}if(this.node.hidden){this.hide()}var c=this.node.getOwnerTree();var d=c.enableDD||c.enableDrag||c.enableDrop;if(d&&(!this.node.isRoot||c.rootVisible)){Ext.dd.Registry.register(this.elNode,{node:this.node,handles:this.getDDHandles(),isHandle:false})}},getDDHandles:function(){return[this.iconNode,this.textNode,this.elNode]},hide:function(){this.node.hidden=true;if(this.wrap){this.wrap.style.display="none"}},show:function(){this.node.hidden=false;if(this.wrap){this.wrap.style.display=""}},onContextMenu:function(b){if(this.node.hasListener("contextmenu")||this.node.getOwnerTree().hasListener("contextmenu")){b.preventDefault();this.focus();this.fireEvent("contextmenu",this.node,b)}},onClick:function(d){if(this.dropping){d.stopEvent();return}if(this.fireEvent("beforeclick",this.node,d)!==false){var a=d.getTarget("a");if(!this.disabled&&this.node.attributes.href&&a){this.fireEvent("click",this.node,d);return}else{if(a&&d.ctrlKey){d.stopEvent()}}d.preventDefault();if(this.disabled){return}if(this.node.attributes.singleClickExpand&&!this.animating&&this.node.isExpandable()){this.node.toggle()}this.fireEvent("click",this.node,d)}else{d.stopEvent()}},onDblClick:function(b){b.preventDefault();if(this.disabled){return}if(this.fireEvent("beforedblclick",this.node,b)!==false){if(this.checkbox){this.toggleCheck()}if(!this.animating&&this.node.isExpandable()){this.node.toggle()}this.fireEvent("dblclick",this.node,b)}},onOver:function(b){this.addClass("x-tree-node-over")},onOut:function(b){this.removeClass("x-tree-node-over")},onCheckChange:function(){var b=this.checkbox.checked;this.checkbox.defaultChecked=b;this.node.attributes.checked=b;this.fireEvent("checkchange",this.node,b)},ecClick:function(b){if(!this.animating&&this.node.isExpandable()){this.node.toggle()}},startDrop:function(){this.dropping=true},endDrop:function(){setTimeout(function(){this.dropping=false}.createDelegate(this),50)},expand:function(){this.updateExpandIcon();this.ctNode.style.display=""},focus:function(){if(!this.node.preventHScroll){try{this.anchor.focus()}catch(f){}}else{try{var d=this.node.getOwnerTree().getTreeEl().dom;var e=d.scrollLeft;this.anchor.focus();d.scrollLeft=e}catch(f){}}},toggleCheck:function(c){var d=this.checkbox;if(d){d.checked=(c===undefined?!d.checked:c);this.onCheckChange()}},blur:function(){try{this.anchor.blur()}catch(b){}},animExpand:function(c){var d=Ext.get(this.ctNode);d.stopFx();if(!this.node.isExpandable()){this.updateExpandIcon();this.ctNode.style.display="";Ext.callback(c);return}this.animating=true;this.updateExpandIcon();d.slideIn("t",{callback:function(){this.animating=false;Ext.callback(c)},scope:this,duration:this.node.ownerTree.duration||0.25})},highlight:function(){var b=this.node.getOwnerTree();Ext.fly(this.wrap).highlight(b.hlColor||"C3DAF9",{endColor:b.hlBaseColor})},collapse:function(){this.updateExpandIcon();this.ctNode.style.display="none"},animCollapse:function(c){var d=Ext.get(this.ctNode);d.enableDisplayMode("block");d.stopFx();this.animating=true;this.updateExpandIcon();d.slideOut("t",{callback:function(){this.animating=false;Ext.callback(c)},scope:this,duration:this.node.ownerTree.duration||0.25})},getContainer:function(){return this.ctNode},getEl:function(){return this.wrap},appendDDGhost:function(b){b.appendChild(this.elNode.cloneNode(true))},getDDRepairXY:function(){return Ext.lib.Dom.getXY(this.iconNode)},onRender:function(){this.render()},render:function(h){var f=this.node,a=f.attributes;var g=f.parentNode?f.parentNode.ui.getContainer():f.ownerTree.innerCt.dom;if(!this.rendered){this.rendered=true;this.renderElements(f,a,g,h);if(a.qtip){this.onTipChange(f,a.qtip,a.qtipTitle)}else{if(a.qtipCfg){a.qtipCfg.target=Ext.id(this.textNode);Ext.QuickTips.register(a.qtipCfg)}}this.initEvents();if(!this.node.expanded){this.updateExpandIcon(true)}}else{if(h===true){g.appendChild(this.wrap)}}},renderElements:function(q,l,m,a){this.indentMarkup=q.parentNode?q.parentNode.ui.getChildIndent():"";var p=Ext.isBoolean(l.checked),t,s=this.getHref(l.href),r=['<li class="x-tree-node"><div ext:tree-node-id="',q.id,'" class="x-tree-node-el x-tree-node-leaf x-unselectable ',l.cls,'" unselectable="on">','<span class="x-tree-node-indent">',this.indentMarkup,"</span>",'<img alt="" src="',this.emptyIcon,'" class="x-tree-ec-icon x-tree-elbow" />','<img alt="" src="',l.icon||this.emptyIcon,'" class="x-tree-node-icon',(l.icon?" x-tree-node-inline-icon":""),(l.iconCls?" "+l.iconCls:""),'" unselectable="on" />',p?('<input class="x-tree-node-cb" type="checkbox" '+(l.checked?'checked="checked" />':"/>")):"",'<a hidefocus="on" class="x-tree-node-anchor" href="',s,'" tabIndex="1" ',l.hrefTarget?' target="'+l.hrefTarget+'"':"",'><span unselectable="on">',q.text,"</span></a></div>",'<ul class="x-tree-node-ct" style="display:none;"></ul>',"</li>"].join("");if(a!==true&&q.nextSibling&&(t=q.nextSibling.ui.getEl())){this.wrap=Ext.DomHelper.insertHtml("beforeBegin",t,r)}else{this.wrap=Ext.DomHelper.insertHtml("beforeEnd",m,r)}this.elNode=this.wrap.childNodes[0];this.ctNode=this.wrap.childNodes[1];var n=this.elNode.childNodes;this.indentNode=n[0];this.ecNode=n[1];this.iconNode=n[2];var o=3;if(p){this.checkbox=n[3];this.checkbox.defaultChecked=this.checkbox.checked;o++}this.anchor=n[o];this.textNode=n[o].firstChild},getHref:function(b){return Ext.isEmpty(b)?(Ext.isGecko?"":"#"):b},getAnchor:function(){return this.anchor},getTextEl:function(){return this.textNode},getIconEl:function(){return this.iconNode},isChecked:function(){return this.checkbox?this.checkbox.checked:false},updateExpandIcon:function(){if(this.rendered){var i=this.node,k,l,h=i.isLast()?"x-tree-elbow-end":"x-tree-elbow",j=i.hasChildNodes();if(j||i.attributes.expandable){if(i.expanded){h+="-minus";k="x-tree-node-collapsed";l="x-tree-node-expanded"}else{h+="-plus";k="x-tree-node-expanded";l="x-tree-node-collapsed"}if(this.wasLeaf){this.removeClass("x-tree-node-leaf");this.wasLeaf=false}if(this.c1!=k||this.c2!=l){Ext.fly(this.elNode).replaceClass(k,l);this.c1=k;this.c2=l}}else{if(!this.wasLeaf){Ext.fly(this.elNode).replaceClass("x-tree-node-expanded","x-tree-node-collapsed");delete this.c1;delete this.c2;this.wasLeaf=true}}var g="x-tree-ec-icon "+h;if(this.ecc!=g){this.ecNode.className=g;this.ecc=g}}},onIdChange:function(b){if(this.rendered){this.elNode.setAttribute("ext:tree-node-id",b)}},getChildIndent:function(){if(!this.childIndent){var d=[],c=this.node;while(c){if(!c.isRoot||(c.isRoot&&c.ownerTree.rootVisible)){if(!c.isLast()){d.unshift('<img alt="" src="'+this.emptyIcon+'" class="x-tree-elbow-line" />')}else{d.unshift('<img alt="" src="'+this.emptyIcon+'" class="x-tree-icon" />')}}c=c.parentNode}this.childIndent=d.join("")}return this.childIndent},renderIndent:function(){if(this.rendered){var d="",c=this.node.parentNode;if(c){d=c.ui.getChildIndent()}if(this.indentMarkup!=d){this.indentNode.innerHTML=d;this.indentMarkup=d}this.updateExpandIcon()}},destroy:function(){if(this.elNode){Ext.dd.Registry.unregister(this.elNode.id)}Ext.each(["textnode","anchor","checkbox","indentNode","ecNode","iconNode","elNode","ctNode","wrap","holder"],function(b){if(this[b]){Ext.fly(this[b]).remove();delete this[b]}},this);delete this.node}});Ext.tree.RootTreeNodeUI=Ext.extend(Ext.tree.TreeNodeUI,{render:function(){if(!this.rendered){var b=this.node.ownerTree.innerCt.dom;this.node.expanded=true;b.innerHTML='<div class="x-tree-root-node"></div>';this.wrap=this.ctNode=b.firstChild}},collapse:Ext.emptyFn,expand:Ext.emptyFn});Ext.tree.TreeLoader=function(b){this.baseParams={};Ext.apply(this,b);this.addEvents("beforeload","load","loadexception");Ext.tree.TreeLoader.superclass.constructor.call(this);if(Ext.isString(this.paramOrder)){this.paramOrder=this.paramOrder.split(/[\s,|]/)}};Ext.extend(Ext.tree.TreeLoader,Ext.util.Observable,{uiProviders:{},clearOnLoad:true,paramOrder:undefined,paramsAsHash:false,nodeParameter:"node",directFn:undefined,load:function(d,f,e){if(this.clearOnLoad){while(d.firstChild){d.removeChild(d.firstChild)}}if(this.doPreload(d)){this.runCallback(f,e||d,[d])}else{if(this.directFn||this.dataUrl||this.url){this.requestData(d,f,e||d)}}},doPreload:function(i){if(i.attributes.children){if(i.childNodes.length<1){var j=i.attributes.children;i.beginUpdate();for(var f=0,g=j.length;f<g;f++){var h=i.appendChild(this.createNode(j[f]));if(this.preloadChildren){this.doPreload(h)}}i.endUpdate()}return true}return false},getParams:function(k){var l=Ext.apply({},this.baseParams),j=this.nodeParameter,h=this.paramOrder;j&&(l[j]=k.id);if(this.directFn){var n=[k.id];if(h){if(j&&h.indexOf(j)>-1){n=[]}for(var m=0,i=h.length;m<i;m++){n.push(l[h[m]])}}else{if(this.paramsAsHash){n=[l]}}return n}else{return l}},requestData:function(h,g,e){if(this.fireEvent("beforeload",this,h,g)!==false){if(this.directFn){var f=this.getParams(h);f.push(this.processDirectResponse.createDelegate(this,[{callback:g,node:h,scope:e}],true));this.directFn.apply(window,f)}else{this.transId=Ext.Ajax.request({method:this.requestMethod,url:this.dataUrl||this.url,success:this.handleResponse,failure:this.handleFailure,scope:this,argument:{callback:g,node:h,scope:e},params:this.getParams(h)})}}else{this.runCallback(g,e||h,[])}},processDirectResponse:function(e,d,f){if(d.status){this.handleResponse({responseData:Ext.isArray(e)?e:null,responseText:e,argument:f})}else{this.handleFailure({argument:f})}},runCallback:function(e,f,d){if(Ext.isFunction(e)){e.apply(f,d)}},isLoading:function(){return !!this.transId},abort:function(){if(this.isLoading()){Ext.Ajax.abort(this.transId)}},createNode:function(attr){if(this.baseAttrs){Ext.applyIf(attr,this.baseAttrs)}if(this.applyLoader!==false&&!attr.loader){attr.loader=this}if(Ext.isString(attr.uiProvider)){attr.uiProvider=this.uiProviders[attr.uiProvider]||eval(attr.uiProvider)}if(attr.nodeType){return new Ext.tree.TreePanel.nodeTypes[attr.nodeType](attr)}else{return attr.leaf?new Ext.tree.TreeNode(attr):new Ext.tree.AsyncTreeNode(attr)}},processResponse:function(q,r,m,i){var e=q.responseText;try{var t=q.responseData||Ext.decode(e);r.beginUpdate();for(var p=0,o=t.length;p<o;p++){var s=this.createNode(t[p]);if(s){r.appendChild(s)}}r.endUpdate();this.runCallback(m,i||r,[r])}catch(n){this.handleFailure(q)}},handleResponse:function(d){this.transId=false;var a=d.argument;this.processResponse(d,a.node,a.callback,a.scope);this.fireEvent("load",this,a.node,d)},handleFailure:function(d){this.transId=false;var a=d.argument;this.fireEvent("loadexception",this,a.node,d);this.runCallback(a.callback,a.scope||a.node,[a.node])},destroy:function(){this.abort();this.purgeListeners()}});Ext.tree.TreeFilter=function(d,c){this.tree=d;this.filtered={};Ext.apply(this,c)};Ext.tree.TreeFilter.prototype={clearBlank:false,reverse:false,autoClear:false,remove:false,filter:function(i,g,f){g=g||"text";var j;if(typeof i=="string"){var h=i.length;if(h==0&&this.clearBlank){this.clear();return}i=i.toLowerCase();j=function(a){return a.attributes[g].substr(0,h).toLowerCase()==i}}else{if(i.exec){j=function(a){return i.test(a.attributes[g])}}else{throw"Illegal filter type, must be string or regex"}}this.filterBy(j,null,f)},filterBy:function(o,p,f){f=f||this.tree.root;if(this.autoClear){this.clear()}var j=this.filtered,k=this.reverse;var n=function(a){if(a==f){return true}if(j[a.id]){return false}var b=o.call(p||a,a);if(!b||k){j[a.id]=a;a.ui.hide();return false}return true};f.cascade(n);if(this.remove){for(var l in j){if(typeof l!="function"){var m=j[l];if(m&&m.parentNode){m.parentNode.removeChild(m)}}}}},clear:function(){var e=this.tree;var f=this.filtered;for(var g in f){if(typeof g!="function"){var h=f[g];if(h){h.ui.show()}}}this.filtered={}}};Ext.tree.TreeSorter=Ext.extend(Object,{constructor:function(j,p){Ext.apply(this,p);j.on({scope:this,beforechildrenrendered:this.doSort,append:this.updateSort,insert:this.updateSort,textchange:this.updateSortParent});var n=this.dir&&this.dir.toLowerCase()=="desc",k=this.property||"text",o=this.sortType,l=this.folderSort,i=this.caseSensitive===true,m=this.leafAttr||"leaf";if(Ext.isString(o)){o=Ext.data.SortTypes[o]}this.sortFn=function(h,b){var d=h.attributes,e=b.attributes;if(l){if(d[m]&&!e[m]){return 1}if(!d[m]&&e[m]){return -1}}var a=d[k],c=e[k],f=o?o(a):(i?a:a.toUpperCase()),g=o?o(c):(i?c:c.toUpperCase());if(f<g){return n?1:-1}else{if(f>g){return n?-1:1}}return 0}},doSort:function(b){b.sort(this.sortFn)},updateSort:function(d,c){if(c.childrenRendered){this.doSort.defer(1,this,[c])}},updateSortParent:function(d){var c=d.parentNode;if(c&&c.childrenRendered){this.doSort.defer(1,this,[c])}}});if(Ext.dd.DropZone){Ext.tree.TreeDropZone=function(d,c){this.allowParentInsert=c.allowParentInsert||false;this.allowContainerDrop=c.allowContainerDrop||false;this.appendOnly=c.appendOnly||false;Ext.tree.TreeDropZone.superclass.constructor.call(this,d.getTreeEl(),c);this.tree=d;this.dragOverData={};this.lastInsertClass="x-tree-no-status"};Ext.extend(Ext.tree.TreeDropZone,Ext.dd.DropZone,{ddGroup:"TreeDD",expandDelay:1000,expandNode:function(b){if(b.hasChildNodes()&&!b.isExpanded()){b.expand(false,null,this.triggerCacheRefresh.createDelegate(this))}},queueExpand:function(b){this.expandProcId=this.expandNode.defer(this.expandDelay,this,[b])},cancelExpand:function(){if(this.expandProcId){clearTimeout(this.expandProcId);this.expandProcId=false}},isValidDropPoint:function(r,e,l,o,p){if(!r||!p){return false}var n=r.node;var m=p.node;if(!(n&&n.isTarget&&e)){return false}if(e=="append"&&n.allowChildren===false){return false}if((e=="above"||e=="below")&&(n.parentNode&&n.parentNode.allowChildren===false)){return false}if(m&&(n==m||m.contains(n))){return false}var q=this.dragOverData;q.tree=this.tree;q.target=n;q.data=p;q.point=e;q.source=l;q.rawEvent=o;q.dropNode=m;q.cancel=false;var k=this.tree.fireEvent("nodedragover",q);return q.cancel===false&&k!==false},getDropPoint:function(r,s,n){var e=s.node;if(e.isRoot){return e.allowChildren!==false?"append":false}var u=s.ddel;var b=Ext.lib.Dom.getY(u),p=b+u.offsetHeight;var q=Ext.lib.Event.getPageY(r);var o=e.allowChildren===false||e.isLeaf();if(this.appendOnly||e.parentNode.allowChildren===false){return o?false:"append"}var t=false;if(!this.allowParentInsert){t=e.hasChildNodes()&&e.isExpanded()}var v=(p-b)/(o?2:3);if(q>=b&&q<(b+v)){return"above"}else{if(!t&&(o||q>=p-v&&q<=p)){return"below"}else{return"append"}}},onNodeEnter:function(g,f,h,e){this.cancelExpand()},onContainerOver:function(e,f,d){if(this.allowContainerDrop&&this.isValidDropPoint({ddel:this.tree.getRootNode().ui.elNode,node:this.tree.getRootNode()},"append",e,f,d)){return this.dropAllowed}return this.dropNotAllowed},onNodeOver:function(q,l,m,n){var e=this.getDropPoint(m,q,l);var p=q.node;if(!this.expandProcId&&e=="append"&&p.hasChildNodes()&&!q.node.isExpanded()){this.queueExpand(p)}else{if(e!="append"){this.cancelExpand()}}var o=this.dropNotAllowed;if(this.isValidDropPoint(q,e,l,m,n)){if(e){var r=q.ddel;var k;if(e=="above"){o=q.node.isFirst()?"x-tree-drop-ok-above":"x-tree-drop-ok-between";k="x-tree-drag-insert-above"}else{if(e=="below"){o=q.node.isLast()?"x-tree-drop-ok-below":"x-tree-drop-ok-between";k="x-tree-drag-insert-below"}else{o="x-tree-drop-ok-append";k="x-tree-drag-append"}}if(this.lastInsertClass!=k){Ext.fly(r).replaceClass(this.lastInsertClass,k);this.lastInsertClass=k}}}return o},onNodeOut:function(g,f,h,e){this.cancelExpand();this.removeDropIndicators(g)},onNodeDrop:function(j,e,k,m){var i=this.getDropPoint(k,j,e);var l=j.node;l.ui.startDrop();if(!this.isValidDropPoint(j,i,e,k,m)){l.ui.endDrop();return false}var n=m.node||(e.getTreeNode?e.getTreeNode(m,l,i,k):null);return this.processDrop(l,m,i,e,k,n)},onContainerDrop:function(g,h,j){if(this.allowContainerDrop&&this.isValidDropPoint({ddel:this.tree.getRootNode().ui.elNode,node:this.tree.getRootNode()},"append",g,h,j)){var i=this.tree.getRootNode();i.ui.startDrop();var e=j.node||(g.getTreeNode?g.getTreeNode(j,i,"append",h):null);return this.processDrop(i,j,"append",g,h,e)}return false},processDrop:function(k,m,e,j,l,o){var n={tree:this.tree,target:k,data:m,point:e,source:j,rawEvent:l,dropNode:o,cancel:!o,dropStatus:false};var p=this.tree.fireEvent("beforenodedrop",n);if(p===false||n.cancel===true||!n.dropNode){k.ui.endDrop();return n.dropStatus}k=n.target;if(e=="append"&&!k.isExpanded()){k.expand(false,null,function(){this.completeDrop(n)}.createDelegate(this))}else{this.completeDrop(n)}return true},completeDrop:function(j){var m=j.dropNode,l=j.point,n=j.target;if(!Ext.isArray(m)){m=[m]}var k;for(var h=0,i=m.length;h<i;h++){k=m[h];if(l=="above"){n.parentNode.insertBefore(k,n)}else{if(l=="below"){n.parentNode.insertBefore(k,n.nextSibling)}else{n.appendChild(k)}}}k.ui.focus();if(Ext.enableFx&&this.tree.hlDrop){k.ui.highlight()}n.ui.endDrop();this.tree.fireEvent("nodedrop",j)},afterNodeMoved:function(g,j,h,i,e){if(Ext.enableFx&&this.tree.hlDrop){e.ui.focus();e.ui.highlight()}this.tree.fireEvent("nodedrop",this.tree,i,j,g,h)},getTree:function(){return this.tree},removeDropIndicators:function(c){if(c&&c.ddel){var d=c.ddel;Ext.fly(d).removeClass(["x-tree-drag-insert-above","x-tree-drag-insert-below","x-tree-drag-append"]);this.lastInsertClass="_noclass"}},beforeDragDrop:function(d,e,f){this.cancelExpand();return true},afterRepair:function(b){if(b&&Ext.enableFx){b.node.ui.highlight()}this.hideProxy()}})}if(Ext.dd.DragZone){Ext.tree.TreeDragZone=function(d,c){Ext.tree.TreeDragZone.superclass.constructor.call(this,d.innerCt,c);this.tree=d};Ext.extend(Ext.tree.TreeDragZone,Ext.dd.DragZone,{ddGroup:"TreeDD",onBeforeDrag:function(e,d){var f=e.node;return f&&f.draggable&&!f.disabled},onInitDrag:function(c){var d=this.dragData;this.tree.getSelectionModel().select(d.node);this.tree.eventModel.disable();this.proxy.update("");d.node.ui.appendDDGhost(this.proxy.ghost.dom);this.tree.fireEvent("startdrag",this.tree,d.node,c)},getRepairXY:function(c,d){return d.node.ui.getDDRepairXY()},onEndDrag:function(d,c){this.tree.eventModel.enable.defer(100,this.tree.eventModel);this.tree.fireEvent("enddrag",this.tree,d.node,c)},onValidDrop:function(e,d,f){this.tree.fireEvent("dragdrop",this.tree,this.dragData.node,e,d);this.hideProxy()},beforeInvalidDrop:function(e,f){var d=this.tree.getSelectionModel();d.clearSelections();d.select(this.dragData.node)},afterRepair:function(){if(Ext.enableFx&&this.tree.hlDrop){Ext.Element.fly(this.dragData.ddel).highlight(this.hlColor||"c3daf9")}this.dragging=false}})}Ext.tree.TreeEditor=function(f,h,e){h=h||{};var g=h.events?h:new Ext.form.TextField(h);Ext.tree.TreeEditor.superclass.constructor.call(this,g,e);this.tree=f;if(!f.rendered){f.on("render",this.initEditor,this)}else{this.initEditor(f)}};Ext.extend(Ext.tree.TreeEditor,Ext.Editor,{alignment:"l-l",autoSize:false,hideEl:false,cls:"x-small-editor x-tree-editor",shim:false,shadow:"frame",maxWidth:250,editDelay:350,initEditor:function(b){b.on({scope:this,beforeclick:this.beforeNodeClick,dblclick:this.onNodeDblClick});this.on({scope:this,complete:this.updateNode,beforestartedit:this.fitToTree,specialkey:this.onSpecialKey});this.on("startedit",this.bindScroll,this,{delay:10})},fitToTree:function(f,j){var h=this.tree.getTreeEl().dom,i=j.dom;if(h.scrollLeft>i.offsetLeft){h.scrollLeft=i.offsetLeft}var g=Math.min(this.maxWidth,(h.clientWidth>20?h.clientWidth:h.offsetWidth)-Math.max(0,i.offsetLeft-h.scrollLeft)-5);this.setSize(g,"")},triggerEdit:function(e,f){this.completeEdit();if(e.attributes.editable!==false){this.editNode=e;if(this.tree.autoScroll){Ext.fly(e.ui.getEl()).scrollIntoView(this.tree.body)}var d=e.text||"";if(!Ext.isGecko&&Ext.isEmpty(e.text)){e.setText("&#160;")}this.autoEditTimer=this.startEdit.defer(this.editDelay,this,[e.ui.textNode,d]);return false}},bindScroll:function(){this.tree.getTreeEl().on("scroll",this.cancelEdit,this)},beforeNodeClick:function(d,c){clearTimeout(this.autoEditTimer);if(this.tree.getSelectionModel().isSelected(d)){c.stopEvent();return this.triggerEdit(d)}},onNodeDblClick:function(d,c){clearTimeout(this.autoEditTimer)},updateNode:function(d,c){this.tree.getTreeEl().un("scroll",this.cancelEdit,this);this.editNode.setText(c)},onHide:function(){Ext.tree.TreeEditor.superclass.onHide.call(this);if(this.editNode){this.editNode.ui.focus.defer(50,this.editNode.ui)}},onSpecialKey:function(f,d){var e=d.getKey();if(e==d.ESC){d.stopEvent();this.cancelEdit()}else{if(e==d.ENTER&&!d.hasModifier()){d.stopEvent();this.completeEdit()}}},onDestroy:function(){clearTimeout(this.autoEditTimer);Ext.tree.TreeEditor.superclass.onDestroy.call(this);var b=this.tree;b.un("beforeclick",this.beforeNodeClick,this);b.un("dblclick",this.onNodeDblClick,this)}});